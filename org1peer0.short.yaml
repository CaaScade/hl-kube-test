service:
  namespace: hltest
  name: peer0
  selector:
    app: org1peer0
  ports:
  - 7050: 7050
  - 7051: 7051
  - 7052: 7052
  - 7053: 7053
---
deployment:
  namespace: hltest
  name: org1peer0
  replicas: 1
  selector:
    app: org1peer0
  containers:
  - name: org1peer0
    image: 693838464287.dkr.ecr.us-east-1.amazonaws.com/test-bundle-org1peer0
    env:
    - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock
    #- CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=blubnet
    # asdf
    - CORE_PEER_ID=peer0
    - CORE_PEER_ADDRESS=peer0:7051
    #- CORE_PEER_GOSSIP_EXTERNALENDPOINT=localhost:7051
    - CORE_PEER_LOCALMSPID=Org1MSP
    # defaults
    - CORE_LOGGING_LEVEL=DEBUG
    - CORE_PEER_TLS_ENABLED=false
    #- CORE_PEER_CHAINCODELISTENADDRESS=peer0:7052
    - CORE_PEER_GOSSIP_USELEADERELECTION=true
    - CORE_PEER_GOSSIP_ORGLEADER=false
    - CORE_PEER_PROFILE_ENABLED=true
    - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt
    - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key
    - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt
    wd: /opt/gopath/src/github.com/hyperledger/fabric/peer
    command:
    - peer
    - node
    - start
    expose:
    - 7051
    - 7053
    volume:
    - mount: /host/var/run/docker.sock
      store: docker
  termination_grace_period: 10
  restart_policy: always
  volumes:
    docker: host_path:/var/run/docker.sock:socket
