pod:
  namespace: hltest
  name: org1admin
  containers:
  - name: org1admin
    image: hyperledger/fabric-tools:x86_64-1.0.5
    env:
    - GOPATH=/opt/gopath
    - CORE_VM_ENDPOINT=http://localhost:2375
    - CORE_PEER_ID=cli
    - CORE_PEER_ADDRESS=peer0:7051
    - CORE_PEER_LOCALMSPID=Org1MSP
    - CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/fabric/msp
    - CORE_CHAINCODE_KEEPALIVE=10
    - CORE_LOGGING_LEVEL=DEBUG
    - CORE_PEER_TLS_ENABLED=false
    wd: /opt/gopath/src/github.com/hyperledger/fabric/peer
    command:
    - sleep
    - infinity
    expose:
    - 7051
    - 7053
    volume:
    - mount: /etc/hyperledger/fabric
      store: config
    - mount: /etc/hyperledger/fabric/msp
      store: msp-target
  - name: dind
    image: docker:dind
    privileged: true
    volume:
    - mount: /var/lib/docker
      store: docker-graph-storage
  init_containers:
  - name: tar
    image: ubuntu:16.04
    command:
    - sh
    - -c
    - |
      set -e
      set -x
      cd /target
      tar -xvf /msp-source/msp.tar.gz
    volume:
    - mount: /target/msp
      store: msp-target
    - mount: /msp-source
      store: msp-config
  termination_grace_period: 0
  restart_policy: never
  volumes:
    docker-graph-storage: empty_dir
    msp-target: empty_dir
    msp-config:
      items:
        msp.tar.gz: bundle
      vol_id: peer0-org1-msp
      vol_type: secret
    config:
      items:
        core.yaml: file
      vol_id: core-yaml
      vol_type: config-map
